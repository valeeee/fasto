Program is:

fun [[int]] writeMMInt([[int]] n) =  map(writeMInt, n)

fun [int] writeMInt([int] n) =  
    let x = write("\n ") in    
    let m2val = map(writeInt, n) in    
    let z = write(" \n") in
    m2val

fun int incr(int x, int m2val) =  (x + m2val)

fun [int] ones([int] a) =  
    let result = 0 in
    map(fn int (int x) => (result + 1), a)

fun int writeInt(int i) =  
    let s = write("\t") in    
    let m2val = write(i) in    
    let z = write("\t") in
    m2val

fun int size([int] a) =  reduce(incr, 0, ones(a))

fun [int] sizeB([[int]] b) =  map(fn int ([int] x) => size(x), b)

fun int mod(int n, int q) =  (n - n / q * q)

fun [int] getIndex(int index, [[int]] array) =  
    let s = sizeB(array) in    
    let m = mod(index, s[0]) in    
    let row = (index / s[0] + 1) in    
    let column = (m + 1) in
    { row, column }

fun int getValue([int] index, [[int]] array) =  
    let i = (index[0] - 1) in    
    let row = array[i] in    
    let column = (index[1] - 1) in
    row[column]

fun int checkValue([int] index, [[int]] array) =  
    let value = getValue({ index[0], index[1] }, array) in
    if ((value == 0))
      then 1
      else 0
  

fun int diagIndex([int] array) =  if ((array[0] == array[1]))
      then 1
      else 0
  

fun int maxIndex([[int]] matrix) =  size(sizeB(matrix)) * size(sizeB(matrix))

fun [[int]] createPosMatrix([[int]] matrix) =  map(fn [int] (int i) => getIndex(i, matrix), iota(maxIndex(matrix)))

fun int checkResult(int x, int i) =  if ((x == 1) && (i == 1))
      then 1
      else 0
  

fun int sumValue([int] array, int m2Val, [[int]] matrix1) =  (getValue(array, matrix1) + m2Val)

fun [int] sumMatrix([int] array1, [int] array2) =  map(fn int (int x) => (array1[x] + array2[x]), iota(size(array1)))

fun [[int]] main() =  
    let matrix1 = { { 1, 2, 3, 4 }, { 5, 6, 7, 8 }, { 9, 10, 11, 12 }, { 13, 14, 15, 16 } } in    
    let matrix2 = { { 1, 1, 1, 1 }, { 1, 1, 1, 1 }, { 1, 1, 1, 1 }, { 1, 1, 1, 1 } } in
    writeMMInt(map(fn [int] (int x) => sumMatrix(matrix1[x], matrix2[x]), iota(size(sizeB(matrix1)))))

+----------------------------------------+
| You might need to enter some input now |
+----------------------------------------+

 	2 		3 		4 		5 	 

 	6 		7 		8 		9 	 

 	10 		11 		12 		13 	 

 	14 		15 		16 		17 	 


Result of 'main': { { 2, 3, 4, 5 }, { 6, 7, 8, 9 }, { 10, 11, 12, 13 }, { 14, 15, 16, 17 } }
