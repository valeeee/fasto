//this will be used in the size function for counting the element array 
fun int incr (int x, int y) = x+y

//create an array with all elements with value 1
fun [int] ones ([int] a) = let result = 0 in map (fn int (int x) => result+1, a)

//this calcuate the size of the array a
fun int size ([int] a) = reduce (incr, 0, ones(a))

//this calculate the length of each row in the bidimensional array b
fun [int] sizeB ([[int]] b) = map (fn int ([int] x) => size (x), b)

fun int mod (int n, int q) = n - ((n/q)*q)

//this function return an array with in a[0] the row index and in a[1] the column index
fun [int] position (int index, [[int]] array) = 
  let s = sizeB(array) in
    let m = mod(index,s[0]) in 
        let row = (index/s[0])+1 in 
             let column = m+1 in 
                {row, column}

fun [int] main () = 
    let array = {{1,2,3},{4,5,6},{7,8,9}} in 
    position(1,array)
